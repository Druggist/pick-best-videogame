package main.resources.rules;
dialect  "mvel"

import org.kie.api.runtime.KieRuntime
import java.util.ArrayList
import javax.swing.JOptionPane
import javax.swing.JFrame
import java.util.Arrays
import java.net.URL
import javax.imageio.ImageIO;
import javax.swing.ImageIcon;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import java.awt.BorderLayout;
import java.awt.Image;

global JFrame frame


declare Choice
	question : String
	answers : ArrayList
	decision : String
end

function String ask(JFrame frame, Choice choice) {
		Object[] options = choice.getAnswers().toArray();
		return options[JOptionPane.showOptionDialog(frame,
											 choice.getQuestion(),
											 "",
											 JOptionPane.YES_NO_OPTION,
											 JOptionPane.QUESTION_MESSAGE,
											 null,
											 options,
											 options[0])].toString();
}

function void showResult(String img){
	JFrame frame = new JFrame();
	frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
	frame.getContentPane().setLayout(new BorderLayout());

	JPanel panel = new JPanel();
	panel.setLayout(new BorderLayout());

	URL url = new URL(img);
	Image image = ImageIO.read(url);

	JLabel label = new JLabel(new ImageIcon(image));
	panel.add(label, BorderLayout.CENTER);

	frame.getContentPane().add(panel, BorderLayout.CENTER);
	frame.pack();
	frame.setVisible(true);
}

rule "ask"
	when
		c : Choice(decision == "")
	then
		c.setDecision(ask(frame, c));
		update(c)
end

rule "init"
	then
		Choice choice = new Choice();
		choice.setQuestion("Do you want to avoid using much of your brain?");
		choice.setAnswers( new ArrayList(Arrays.asList("Yes", "No")));
		choice.setDecision("");
		insert(choice);
end

rule "Do you want to avoid using much of your brain?"
	when
		c : Choice(question == "Do you want to avoid using much of your brain?")
	then
		Choice choice = new Choice();
		if (c.getDecision().equals(c.getAnswers().get(0))) {
			choice.setQuestion("How are your reflexes?");
			choice.setAnswers(new ArrayList(Arrays.asList("Unreal", "Average")));
		} else {
			choice.setQuestion("Maximum creativity?");
			choice.setAnswers(new ArrayList(Arrays.asList("No", "Yes")));
		}
		choice.setDecision("");
		insert(choice);
end

rule "How are your reflexes?"
	when
		c : Choice(question == "How are your reflexes?")
	then
		Choice choice = new Choice();
		if (c.getDecision().equals(c.getAnswers().get(0))) {
			choice.setQuestion("Are you on drugs?");
			choice.setAnswers(new ArrayList(Arrays.asList("Yes", "No")));
		} else {
			choice.setQuestion("Do you want to point and click click click...?");
			choice.setAnswers(new ArrayList(Arrays.asList("No", "Yes")));
		}
		choice.setDecision("");
		insert(choice);
end

rule "Are you on drugs?"
	when
		c : Choice(question == "Are you on drugs?")
	then
		if (c.getDecision().equals(c.getAnswers().get(0))) {
			showResult("https://upload.wikimedia.org/wikipedia/en/7/71/RezBoxArt.jpg");
		} else {
			Choice choice = new Choice();
			choice.setQuestion("Do you want to feel like?");
			choice.setAnswers(new ArrayList(Arrays.asList("Yes", "No")));
			choice.setDecision("");
			insert(choice);
		}
end

rule "Do you want to feel like?"
	when
		c : Choice(question == "Do you want to feel like?")
	then
		if (c.getDecision().equals(c.getAnswers().get(0))) {
			showResult("http://www.defunctgames.com/pic/reviewpics/reviewgeometrywars2xbla-2.jpg");
		} else {
			Choice choice = new Choice();
			choice.setQuestion("How's your timing?");
			choice.setAnswers(new ArrayList(Arrays.asList("Superb", "Average")));
			choice.setDecision("");
			insert(choice);
		}
end

rule "How's your timing?"
	when
		c : Choice(question == "How's your timing?")
	then
		Choice choice = new Choice();
		if (c.getDecision().equals(c.getAnswers().get(0))) {
			choice.setQuestion("You want to rock out?");
			choice.setAnswers(new ArrayList(Arrays.asList("Yes", "No")));
		} else {
			choice.setQuestion("Are 2 buttons to many for you?");
			choice.setAnswers(new ArrayList(Arrays.asList("Yes", "No")));
		}
		choice.setDecision("");
		insert(choice);
end

rule "You want to rock out?"
	when
		c : Choice(question == "You want to rock out?")
	then
		if (c.getDecision().equals(c.getAnswers().get(0))) {
			showResult("https://upload.wikimedia.org/wikipedia/en/3/3b/Rock_Band_3_Game_Cover.jpg");
		} else {
			showResult("https://images-na.ssl-images-amazon.com/images/I/51%2Be-1oylUL._SY445_.jpg");
		}
end

rule "Are 2 buttons to many for you?"
	when
		c : Choice(question == "Are 2 buttons to many for you?")
	then
		if (c.getDecision().equals(c.getAnswers().get(0))) {
			showResult("https://www.homeleisuredirect.com/Assets/HLD/User/16574-mc%20pacman%20.png");
		} else {
			showResult("http://www.mobygames.com/images/covers/l/78995-super-punch-out-snes-front-cover.png");
		}
end

rule "Do you want to point and click click click...?"
	when
		c : Choice(question == "Do you want to point and click click click...?")
	then
		Choice choice = new Choice();
		if (c.getDecision().equals(c.getAnswers().get(0))) {
			choice.setQuestion("Do you want the hardest game ever?");
			choice.setAnswers(new ArrayList(Arrays.asList("No", "Yes")));
		} else {
			choice.setQuestion("Do you plan on playing for the next week straight?");
			choice.setAnswers(new ArrayList(Arrays.asList("Yes", "No")));
		}
		choice.setDecision("");
		insert(choice);
end

rule "Do you want the hardest game ever?"
	when
		c : Choice(question == "Do you want the hardest game ever?")
	then
		if (c.getDecision().equals(c.getAnswers().get(0))) {
			showResult("https://upload.wikimedia.org/wikipedia/en/thumb/7/77/Super_Monkey_Ball_Adventure_Coverart.png/220px-Super_Monkey_Ball_Adventure_Coverart.png");
		} else {
			showResult("https://upload.wikimedia.org/wikipedia/en/7/76/Devil_May_Cry_3_boxshot.jpg");
		}
end

rule "Do you plan on playing for the next week straight?"
	when
		c : Choice(question == "Do you plan on playing for the next week straight?")
	then
		if (c.getDecision().equals(c.getAnswers().get(0))) {
			showResult("https://blznav.akamaized.net/img/games/cards/card-world-of-warcraft-54576e6364584e35.jpg");
		} else {
			showResult("https://upload.wikimedia.org/wikipedia/en/d/d5/Diablo_II_Coverart.png");
		}
end

rule "Maximum creativity?"
	when
		c : Choice(question == "Maximum creativity?")
	then
		if(c.getDecision().equals(c.getAnswers().get(0))) {
			Choice choice = new Choice();
			choice.setQuestion("Do you want to solve some puzzles?");
			choice.setAnswers(new ArrayList(Arrays.asList("Yes", "No")));
			choice.setDecision("");
			insert(choice);
		} else {
			showResult("http://www.mobygames.com/images/covers/l/319702-minecraft-playstation-4-edition-minecraft-plastic-texture-pack-playstation-4-front-cover.jpg");
		}
end

rule "Do you want to solve some puzzles?"
	when
		c : Choice(question == "Do you want to solve some puzzles?")
	then
		Choice choice = new Choice();
		choice.setDecision("");
		if(c.getDecision().equals(c.getAnswers().get(0))) {
			choice.setQuestion("Do you feel the need for storyline as well?");
			choice.setAnswers(new ArrayList(Arrays.asList("No", "Yes")));
		} else {
			choice.setQuestion("Do you enjoy simulations?");
            choice.setAnswers(new ArrayList(Arrays.asList("No", "Yes")));
		}
		insert(choice);
end

rule "Do you feel the need for storyline as well?"
	when
		c : Choice(question == "Do you feel the need for storyline as well?")
	then
		Choice choice = new Choice();
		choice.setDecision("");
		if(c.getDecision().equals(c.getAnswers().get(0))) {
			choice.setQuestion("Kick it oldschool?");
			choice.setAnswers(new ArrayList(Arrays.asList("Yes", "No")));
		} else {
			choice.setQuestion("Are you an Edward Gorey fan?");
            choice.setAnswers(new ArrayList(Arrays.asList("Yes", "No")));
		}
		insert(choice);
end

rule "Kick it oldschool?"
	when
		c : Choice(question == "Kick it oldschool?")
	then
		if (c.getDecision().equals(c.getAnswers().get(0))) {
			showResult("https://www.blogcdn.com/www.joystiq.com/media/2013/02/tetris.jpg");
		} else {
			showResult("https://static.gamespot.com/uploads/screen_kubrick/1551/15511094/3123122-lumines.jpg");
		}
end

rule "Are you an Edward Gorey fan?"
	when
		c : Choice(question == "Are you an Edward Gorey fan?")
	then
		if(c.getDecision().equals(c.getAnswers().get(0))) {
			showResult("http://www.mobygames.com/images/covers/l/300355-limbo-playstation-4-front-cover.jpg");
		} else {
	    	Choice choice = new Choice();
	    	choice.setDecision("");
			choice.setQuestion("Looking for crazy Japanese awesomeness?");
            choice.setAnswers(new ArrayList(Arrays.asList("No", "Yes")));
		    insert(choice);
		}
end

rule "Looking for crazy Japanese awesomeness?"
	when
		c : Choice(question == "Looking for crazy Japanese awesomeness?")
	then
		if(c.getDecision().equals(c.getAnswers().get(0))) {
	    	Choice choice = new Choice();
	    	choice.setDecision("");
			choice.setQuestion("Do you want shiny textures or indi magic?");
            choice.setAnswers(new ArrayList(Arrays.asList("Indi", "Shiny")));
		    insert(choice);
		} else {
			showResult("https://upload.wikimedia.org/wikipedia/en/a/aa/KatamariDamacybox.jpg");
		}
end

rule "Do you want shiny textures or indi magic?"
	when
		c : Choice(question == "Do you want shiny textures or indi magic?")
	then
		if(c.getDecision().equals(c.getAnswers().get(0))) {
	    	showResult("https://e.snmc.io/lk/f/l/155559a5e55f4565829b33431af6bb9a/2939359.jpg");
		} else {
			showResult("http://cdn.akamai.steamstatic.com/steam/apps/620/header.jpg?t=1490208943");
		}
end